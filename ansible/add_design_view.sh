#!/bin/sh
curl -X PUT http://admin:admin@172.26.130.106:5984/twitter_adelaide_processed/_design/sentiment --data '{"views":{"ave_score":{"map":"function(doc){if(doc.lang_detected === \"en\"){emit(doc.lang_detected, doc.happines);}}","reduce":"function(keys,values,rereduce){if(!rereduce){var length = values.length; return [sum(values) / length, length]}else{var length = sum(values.map(function(v){return v[1]}));var avg = sum(values.map(function(v){return v[0] * (v[1] / length)}));return [avg, length]}}"}}}'
curl -X PUT http://admin:admin@172.26.130.106:5984/twitter_sydney_processed/_design/sentiment --data '{"views":{"ave_score":{"map":"function(doc){if(doc.lang_detected === \"en\"){emit(doc.lang_detected, doc.happines);}}","reduce":"function(keys,values,rereduce){if(!rereduce){var length = values.length; return [sum(values) / length, length]}else{var length = sum(values.map(function(v){return v[1]}));var avg = sum(values.map(function(v){return v[0] * (v[1] / length)}));return [avg, length]}}"}}}'
curl -X PUT http://admin:admin@172.26.130.106:5984/twitter_perth_processed/_design/sentiment --data '{"views":{"ave_score":{"map":"function(doc){if(doc.lang_detected === \"en\"){emit(doc.lang_detected, doc.happines);}}","reduce":"function(keys,values,rereduce){if(!rereduce){var length = values.length; return [sum(values) / length, length]}else{var length = sum(values.map(function(v){return v[1]}));var avg = sum(values.map(function(v){return v[0] * (v[1] / length)}));return [avg, length]}}"}}}'
curl -X PUT http://admin:admin@172.26.130.106:5984/twitter_melbourne_processed/_design/sentiment --data '{"views":{"ave_score":{"map":"function(doc){if(doc.lang_detected === \"en\"){emit(doc.lang_detected, doc.happines);}}","reduce":"function(keys,values,rereduce){if(!rereduce){var length = values.length; return [sum(values) / length, length]}else{var length = sum(values.map(function(v){return v[1]}));var avg = sum(values.map(function(v){return v[0] * (v[1] / length)}));return [avg, length]}}"}}}'
curl -X PUT http://admin:admin@172.26.130.106:5984/twitter_brisbane_processed/_design/sentiment --data '{"views":{"ave_score":{"map":"function(doc){if(doc.lang_detected === \"en\"){emit(doc.lang_detected, doc.happines);}}","reduce":"function(keys,values,rereduce){if(!rereduce){var length = values.length; return [sum(values) / length, length]}else{var length = sum(values.map(function(v){return v[1]}));var avg = sum(values.map(function(v){return v[0] * (v[1] / length)}));return [avg, length]}}"}}}'


# curl -X GET http://admin:admin@172.26.130.106:5984/twitter_adelaide_processed/_design/sentiment/_view/ave_score